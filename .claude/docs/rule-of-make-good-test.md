# 🧠 AI 에이전트를 위한 테스트 이해 및 작성 룰

## 1️⃣ 테스트란 무엇인가?

테스트(Test)는 **코드가 의도대로 작동하는지를 검증하는 과정**입니다.  
이는 단순한 오류 탐지를 넘어, **품질 유지·개선의 핵심 도구**로서 코드의 신뢰성을 높이고  
리팩터링과 빠른 배포를 가능하게 합니다.

---

## 2️⃣ 테스트가 코드에 미치는 긍정적 영향

### 💡 1) 사려 깊은 설계를 유도한다

- 테스트 작성은 **API와 인터페이스 설계의 검증 행위**이다.
- 테스트를 먼저 작성하면 필요한 기능과 입력·출력을 명확히 정의하게 되어,  
  **좋은 설계와 구조적 사고**를 유도한다.
- 테스트가 통과되는 시점이 곧 “기능이 완성된 시점”이 된다.

### ⚙️ 2) 안전한 변경과 빠른 배포를 가능하게 한다

- 마틴 파울러는 “조금씩 수정하고 매번 테스트하는 습관이 리팩터링의 핵심”이라 강조했다.
- 테스트는 변경 후 영향 범위를 최소화하고, 오류 원인을 빠르게 파악하게 한다.
- 이를 통해 **디버깅 시간 단축**과 **안정적 배포**가 가능하다.

### 📘 3) 실행 가능한 문서 역할을 한다

- 테스트는 “**동작을 설명하는 문서**”다.
- 테스트를 읽는 것만으로 코드의 목적과 기능을 이해할 수 있으며,  
  팀 내 커뮤니케이션 수단으로 활용될 수 있다.

### ⚡ 4) 검증 시간과 비용을 줄인다

- 사전 테스트가 존재하면 코드 리뷰와 QA 단계의 부담이 줄어든다.
- 예외 상황, 오류 케이스를 자동 검증하므로 **전체 개발 사이클 효율이 높아진다.**

---

## 3️⃣ 테스트의 접근 방식

| 구분          | **구현 기반 테스트**          | **명세 기반 테스트**                   |
| ------------- | ----------------------------- | -------------------------------------- |
| **개념**      | 내부 로직·코드 구조 중심      | 외부 동작·요구사항 중심                |
| **관점**      | 개발자 관점 (화이트박스)      | 사용자 관점 (블랙박스)                 |
| **장점**      | 세부 로직 검증, 커버리지 향상 | 구현 변경에 둔감, 요구사항 검증에 용이 |
| **단점**      | 변경 시 테스트 수정 필요      | 내부 오류 검출에 한계                  |
| **적합 사례** | 단위, 알고리즘, 성능 테스트   | 통합, 인수, UI 테스트                  |

> 💬 핵심 요약:  
> 내부 검증(품질)과 외부 검증(사용자 만족)은 모두 필요하며,  
> 두 접근법은 상호 보완적으로 사용해야 한다.

---

## 4️⃣ 좋은 테스트를 위한 핵심 원칙

### 🧩 ① 인터페이스 중심으로 작성하라

- 내부 구현이 아닌 **외부 공개 API(public method)** 기준으로 테스트한다.
- 내부 로직에 의존한 테스트는 변경에 취약하므로,  
  **사용자 시점의 동작**을 기준으로 검증해야 한다.

### 🎯 ② 커버리지보다 의미를 우선하라

- 단순히 커버리지를 높이기보다, **실질적으로 오류를 방지할 테스트**에 집중한다.
- 단순한 유틸리티 함수나 불변 로직은 생략하고,  
  **주요 기능 흐름과 사용자 시나리오 중심으로 테스트한다.**

### ✍️ ③ 테스트 코드도 “읽기 쉬운 코드”다

- 테스트 설명(`it`, `describe`)은 명확하고 서술적으로 작성한다.  
  예: `it('사용자가 잘못된 비밀번호를 입력하면 오류 메시지를 표시한다.')`
- 테스트만 읽어도 **기능의 의도와 결과가 명확히 드러나야 한다.**

### 🧱 ④ 한 테스트에는 한 동작만 검증하라

- 여러 동작을 한 테스트에 담지 않는다.
- 각 동작은 독립적인 테스트로 분리해 **가독성과 신뢰성을 유지**한다.

---

## 5️⃣ 테스트 작성 구조 (GWT 패턴)

테스트는 **GWT (Given–When–Then)** 패턴을 따른다.

| 단계      | 역할                                        |
| --------- | ------------------------------------------- |
| **Given** | 테스트를 위한 환경 및 초기 상태를 설정한다. |
| **When**  | 사용자의 행동이나 시스템의 동작을 실행한다. |
| **Then**  | 결과가 예상대로 나왔는지 검증한다.          |

> **핵심 원리:**  
> “조건이 주어졌을 때(Given), 특정 행동을 수행하면(When), 기대되는 결과가 나와야 한다(Then).”

---

## 6️⃣ AI 에이전트를 위한 테스트 작성 체크리스트

| 항목              | 점검 질문                                                     |
| ----------------- | ------------------------------------------------------------- |
| 🧾 **명확성**     | 테스트 이름만으로 어떤 기능을 검증하는지 이해되는가?          |
| 🧩 **독립성**     | 테스트 간 데이터나 상태가 섞이지 않는가?                      |
| 🎯 **의미성**     | 실제 동작 검증에 필요한 테스트인가, 단순 커버리지용은 아닌가? |
| 🔁 **재현성**     | 실행 순서나 환경이 달라도 동일한 결과가 나오는가?             |
| 🔧 **유지보수성** | 구현 변경 시 테스트가 불필요하게 깨지지 않는가?               |
| 🧠 **가독성**     | 테스트를 읽는 것만으로 기능의 의도가 전달되는가?              |

---

## 7️⃣ AI 에이전트를 위한 테스트 방향성

1. **목표 기반 사고:**

   - 테스트는 코드의 모든 라인을 검증하기 위한 것이 아니라, **“의도된 동작을 보장”**하는 것이 목적이다.

2. **사용자 관점 시뮬레이션:**

   - 테스트를 “사용자 행동의 모의 시나리오”로 바라보고,  
     입력 → 동작 → 결과의 흐름을 인간처럼 이해하도록 학습한다.

3. **변화 감내성:**

   - 내부 구현이 바뀌어도 깨지지 않는 **유연한 테스트 작성법**을 학습한다.
   - 즉, “무엇을 테스트해야 하는가?”를 우선적으로 판단하라.

4. **지속적 피드백 루프:**
   - 테스트는 단발성 검증이 아닌, **지속적 품질 관리 도구**다.
   - 빠르게 실행되고 반복 가능해야 한다.

---

## 8️⃣ AI 에이전트 테스트 작성 지침 (Rules)

1. **테스트는 명세 기반 사고로 시작하라.**

   - 사용자나 시스템 요구사항을 기반으로 테스트 시나리오를 설계한다.

2. **Given–When–Then 구조를 항상 유지하라.**

   - 테스트 로직의 흐름을 명확히 구분함으로써 사고 체계를 표준화한다.

3. **테스트 실패 시 원인을 설명할 수 있어야 한다.**

   - 실패 로그만이 아니라, “왜 실패했는지”를 스스로 해석하고 피드백할 수 있어야 한다.

4. **테스트 케이스는 독립적으로 실행 가능해야 한다.**

   - 순서 의존이나 전역 상태를 최소화한다.

5. **테스트의 목적을 서술형으로 기록하라.**

   - `it('…을 검증한다')` 형태의 자연어 서술을 사용한다.

6. **중복 검증보다 의미 있는 검증을 우선하라.**

   - 이미 상위 로직에서 충분히 검증된 부분은 반복하지 않는다.

7. **테스트 데이터는 예측 가능하고 명확해야 한다.**

   - 입력 데이터는 테스트 목적을 드러내며, 불필요한 복잡성을 피한다.

8. **테스트는 학습 가능한 문장으로 표현하라.**

   - AI 에이전트가 “테스트의 목적과 결과”를 자연어로 해석할 수 있도록 구성한다.

9. **테스트를 통해 설계 의도를 학습하라.**

   - 코드의 구조와 의도를 추론하는 연습의 도구로 삼는다.

10. **결과를 기록하고 패턴화하라.**

- 테스트 실패의 유형을 분류하고, 개선 학습에 활용한다.
